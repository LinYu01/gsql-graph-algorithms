/******************************************************************************
 * Copyright (c) 2016, TigerGraph Inc.
 * All rights reserved.
 * Project: TigerGraph Query Language
 *
 * - This library is for defining struct and helper functions that will be used
 *   in the user-defined functions in "ExprFunctions.hpp". Note that functions
 *   defined in this file cannot be directly called from TigerGraph Query scripts.
 *   Please put such functions into "ExprFunctions.hpp" under the same directory
 *   where this file is located.
 *
 * - Please don't remove necessary codes in this file
 *
 * - A backup of this file can be retrieved at
 *     <tigergraph_root_path>/dev_<backup_time>/gdk/gsql/src/QueryUdf/ExprUtil.hpp
 *   after upgrading the system.
 *
 ******************************************************************************/

#ifndef EXPRUTIL_HPP_
#define EXPRUTIL_HPP_

#include <stdlib.h>
#include <stdio.h>
#include <string>
#include <gle/engine/cpplib/headers.hpp>
#include <vector>

typedef std::string string; //XXX DON'T REMOVE
const uint64_t BASE = 1ULL << 63;
const int64_t MOD = 9223372036854775783;
const int64_t HASH_CONST[1001] = {1, 25, 625, 15625, 390625, 9765625, 244140625, 6103515625, 152587890625, 3814697265625, 95367431640625, 2384185791015625, 59604644775390625, 1490116119384765625, 359414837200037493, 8985370930000937325, 3273344365508814333, 8046632842882152061, 7475008298103510082, 2407766715492236390, 4853935666177255052, 1444555175319291121, 8443763272417950676, 8179896999643699674, 1583240180287424624, 2687516359766512468, 2624304736179381219, 1044014146501099994, 7653609588817948284, 6872798983353191440, 5799277920443821906, 6631367458273910905, 8986861830316584314, 3310616873399989058, 8978445540161520186, 3100209619523385858, 3718264193246440186, 722884462613246820, 8848739528476394717, 9080931364250024916, 5662355221736004108, 3208299990578465955, 6420523469623442611, 3715762114054876964, 660332482824166270, 7284940033749380967, 6879432143493784298, 5965106923958643356, 1553720509289671372, 1949524584822681168, 2621254436293150285, 967756649345326644, 5747172159923614534, 5328723445268726605, 4090877615751304163, 814847988380070462, 1924455635792209984, 1994530710531370685, 3746407579010388210, 1426469106711947420, 7991611557234358151, 6099476156908662332, 4912951333040145772, 2919946846891559121, 8435066914305547544, 7962488046833621374, 5371388396890242907, 5157501406289211713, 9033698678118207646, 4481538068440572358, 1357987268756999554, 6279565608360661501, 191815582485349214, 4795389562133730350, 9204274611085949354, 8745936392634115058, 6510852968193033441, 5973999578294647714, 1776036867689780322, 7507433544825404918, 3218397883539607290, 6672970793651975986, 803573177913435556, 1642585374126337334, 4171146205739330218, 2821562738080721837, 5975464194034615444, 1812652261188973572, 8422818382305236168, 7656274746825836974, 6939427933550408690, 7465001675374253156, 2157601147260813240, 7823168497246452085, 1888399657211010682, 1093131246001388135, 8881537076325151809, 677498023614176433, 7714078553499635042, 8384523100395360390, 6698892699078942524, 1451620813587599006, 8620404229125647801, 3372548880481352016, 1303373680340818353, 4914225897956131476, 2951810969791201721, 8297949941836761, 207448748545919025, 5186218713647975625, 528259325232529663, 3983111093958465792, 7344056980413886970, 8357355810106434373, 6019710441855792099, 2918808456718389947, 8406607159976318194, 7250994188602887624, 6030786014831450723, 3195697781109855547, 6105468232908182411, 5062753233028147747, 6664994346591608496, 604162001404248306, 5880677998251431867, 8666369403464159930, 4521678238944155241, 2361491531346571629, 3697056062535636027, 192681194843142845, 4817029871078571125, 521910297852192946, 3824385409450047867, 3375914867703438845, 1387523360892989078, 7017967911760399601, 205129093769250148, 5128227344231253700, 8301847126669257321, 4631993355926365799, 5119369455901835579, 8080399918433804296, 8319185186894815957, 5065444861565331699, 6732285060021207296, 2286429837144218306, 1820513707476802952, 8619354539500970668, 3346306639864423691, 647317664917610228, 6959569586085479917, 7968542988751033831, 5522761944825554332, 8941840104671997338, 2185073732285314658, 8509983122858987535, 612021223814845366, 6077158558516358367, 4355011373232546647, 7418191925411132562, 987357398182798390, 6237190880860408184, 8355819431833792072, 5981300985039734574, 1958572036316951822, 2847440723649916635, 6622413833264485394, 8763021205080946539, 6937973279363820466, 7428635320709547556, 1248442280643173240, 3540940905515003651, 5513174306182109228, 8702149138585869738, 5416171616986900441, 6277081908705650063, 129723091110063264, 3243077277751581600, 7289955648951333736, 7004822523542603523, 9099866425179123981, 6135731744963480733, 5819341034410605797, 7132945307443508180, 3079563985846964623, 3202123351335909311, 6266107488559526511, 9078734624311750247, 5607436723279137383, 1835337529156797830, 8989950081500842618, 3387823153006446658, 1685230493468184403, 5237274189285506943, 1804646216170812613, 8222667256851212193, 2652496610475237599, 1748811003897509494, 6826786950018634218, 4648977087079891356, 5543962734739974504, 248487815677725855, 6212195391943146375, 7730932208902246847, 8805864485460655515, 8009055288856544866, 6535569447463330207, 6591911560052066864, 8000464374770483289, 6320796595311790782, 1222590256263581239, 2894640296025203626, 7802403142646660169, 1369265792216212782, 6561528694840992201, 7240892744493616714, 5778249912099677973, 6105667249670312580, 5067728652081401972, 6789379822922964121, 3713798909688138931, 611252373655715445, 6057937304538110342, 3874480023776346022, 4628280225860892720, 5026541204265008604, 5759693627513129921, 5641760135006611280, 2693422822343645255, 2771966300607700894, 4735553257209091869, 7708366987969987329, 8241733962154167565, 3129164243049121899, 4442129781389841211, 372780092488720879, 96130275363246192, 2403256884081154800, 4741189880900215302, 7849282580248073154, 2541251732251537407, 8191061085159780477, 1862342318189444699, 441697770462238560, 1819072224701188217, 8583317470110602293, 2445379905105214316, 5794265406501703202, 6506054609720943305, 5854040616492394314, 8000434859488221105, 6320058713255236182, 1204143204849716239, 2433464010678578626, 5496368045835810952, 8281992629928412838, 4135630937405253724, 1933681029728809487, 2225165558946358260, 288906752530301802, 7222668813257545050, 5322651631197886373, 3939082263980298363, 6243336230959701245, 8509453184316118597, 598772760243121916, 5745946969223272117, 5298093677760166180, 3325133428037293538, 117987369239356403, 2949684230983910075, 9178501516614321394, 8101609030843416058, 8849412997135110007, 9097768080717907166, 6083273133433060358, 4507875746150096422, 2016429211495101154, 4293870103103649935, 5889660172188714762, 8890923751896232305, 912164912891188833, 4357378748570169259, 7477376308851697862, 2466966984196930890, 6333942383794617552, 1551234968334250489, 1887386060937159093, 1067791339155098410, 8248039405167908684, 3286800318392649874, 8383031664978040586, 6661606813645947424, 519473677762721506, 3763469907213261867, 1853027311783788845, 208822610320842210, 5220565258021055250, 1386922934559520288, 7002957253423679851, 9053234672206032181, 4969937920636185733, 4344611536792558146, 7158196014411420037, 3710831660044761048, 537071132571268370, 4203406277426933467, 3628064530270803062, 7691264925077094503, 7814182389831846915, 1663746971845881432, 4700186148727932668, 6824189275941007304, 4584035235139218506, 3920416436223153254, 5776690537031073520, 6066682872955201255, 4093119234203618847, 870888449687937562, 3325467168488887484, 126330880529205053, 3158272013230126325, 5169824035914951861, 118392381906935563, 2959809547673389075, 208262396996520611, 5206559924913015275, 1036789606858520913, 7472996097753471259, 2357461706741265815, 3596310447402990677, 6897412853381784878, 6414624671158657856, 3568292152435258089, 6196955479188470178, 7349934390035341922, 8504291050642808173, 469719418410361316, 2519613423404257117, 7650103363977773227, 6785143362348815015, 3607887395334411281, 7186836551667299978, 4426845091441759573, 9214034880641455712, 8989943131521774008, 3387649403529731408, 1680886756550303153, 5128680766338475693, 8313182679349807146, 4915382172940111424, 2980717844390700421, 730969814929304261, 9050873336377830742, 4910904524931149758, 2868776644166658771, 7155811846183038794, 3651227454335229973, 8270338026687767278, 3844265856389114724, 3872926041180110270, 4589430660954998920, 4055302081617663604, 9148831671893832270, 7359862912831187958, 8752504120538959073, 6675046165814133816, 855457481967381306, 2939692975474981084, 8928720128891096619, 1857074337762796683, 309998259796038160, 7749956494900954000, 58099598573558557, 1452489964338963925, 8642132997909770776, 3915768100084426391, 5660482133562901945, 3161472786250911880, 5249843361434590736, 2118875519897907438, 6855027813173807035, 5354998665959211781, 4747758133013433563, 8013488883078529679, 6646409303012950532, 139535911937799206, 3488397798444980150, 4199596629431521703, 3532823330385508962, 5310234927944742003, 3628664682651689113, 7706268734599245778, 8189277627885628790, 1817755886335652524, 8550409010972209968, 1622668426645406191, 3673222518716051643, 8820214636208309028, 8367809057547882691, 6281041627892000049, 228716070768812914, 5717901769220322850, 4596963677686434505, 4243627499903553229, 4633595092186297112, 5159412862400118404, 9081485080890874921, 5676198137757254233, 3554372891109719080, 5848973946049994953, 7873768098428237080, 3153389686755635557, 5047765874052682661, 6290310372204981346, 460434678593345339, 2287494927978857692, 1847140978342787602, 61664274295811135, 1541606857395278375, 1646683287462856243, 4273594039152302943, 5382758573405039962, 5441755819159138088, 6916686963011591238, 6896477411903816856, 6391238634209457306, 2983641228705244339, 804054422792902211, 1654616496113003709, 4471924255405989593, 1117641942892430429, 270932461746433376, 6773311543660834400, 3312091928134895906, 9015321908534191386, 4022118828840165858, 8319250352456388620, 5067074000604648274, 6773013536004121671, 3304641736717077681, 8829067123088735761, 8589121229558551016, 2590473891303932391, 198243024614879294, 4956075615371982350, 3998053905187473571, 7717627261139081445, 8473240791381520465, 8916834973732944399, 1559945458808991183, 2105148322805676443, 6511847885868032160, 5998872520169615689, 2397860414563979697, 4606278142970837727, 4476489132013633779, 1231763858083535079, 3123980341524049626, 4312532243263034386, 6356213676173326037, 2108017277801962614, 6583571760775186435, 7791969392848472564, 1108422047261522657, 40435070973739076, 1010876774343476900, 6825175284877370934, 4608685458548309256, 4536672021450422004, 2736336094003240704, 3844798092097587119, 3886231933891920145, 4922077978750245795, 3148112989644059696, 4915848446263286136, 2992374677470068221, 1022390641913499261, 7113021974127929959, 2581480652957509098, 9196784102809072752, 8558673685712200008, 1829285295145157191, 8838644231209826643, 8828548932585823066, 8576166466985733641, 2266604826983498016, 1324888453458795702, 5452095225905565201, 7175172131672269063, 4135234591565986698, 1923772383747133837, 1977449409404467010, 3319375050837796335, 9197399976106702111, 8574070518152933983, 2214206106163506566, 14920432959009452, 373010823975236300, 101898562526131717, 2547464063153292925, 8346369357703668427, 5745049131786643449, 5275647741844449480, 2763985030144376038, 4536021495625970469, 2720072948391952329, 3438219451815377744, 2945137963691461553, 9064844834303108344, 5260191973063089808, 2377590810610384238, 4099538044130951252, 1031358697871247687, 7337223373071640609, 8186515626550275348, 1748705852951816474, 6824158176376308718, 4583257746021753856, 3900979208286537004, 5290759838615667270, 3141787449424820788, 4757709940782313436, 8262284077300526504, 3642917121708095374, 8062579711009402303, 7873680001284766132, 3151187258168861857, 4992705159383340161, 4913792505471418846, 2940976157673385971, 8960799683851218794, 2659063211765851058, 1912976036162845969, 1707540719797270310, 5795029847512654618, 6525165634994728705, 6331816248337029314, 1498081581894544539, 558551399944510343, 4740412961757982792, 7829859601692260404, 2055677268356218657, 5275071524631587510, 2749579599822826788, 4175885737587239219, 2940051034278446862, 8937671598977741069, 2080861089928907933, 5904667063948819410, 42724009044072722, 1068100226101818050, 8255761578835899684, 3479854660092424874, 3986018170617639803, 7416733896893237245, 950906685235415465, 5325923057175835059, 4020867913429015513, 8287977467177629995, 4285251868635682649, 5674204310489532612, 3504527209416678555, 4602831903723981828, 4390333150842236304, 8301236365653373987, 4616724330529282449, 4737643820974751829, 7760631082111486329, 324964278836866782, 8124106970921669550, 188489462236671524, 4712236555916788100, 7125449455662393104, 2892167691319087723, 7740588024993762594, 9047259887748549190, 4820568309199110958, 610371250865688771, 6035909234787443492, 3323778280009674772, 84108668548887253, 2102716713722181325, 6451057658780654210, 4479116842985166939, 1297456632371864079, 4766299698732274626, 8477028026049556254, 9011515840433839124, 3926967126331359308, 5940457789736224870, 937492153729209222, 4990559769520678984, 4860157758904889421, 1600107493510150346, 3109199190334655518, 3943003463528181686, 6341366219656784320, 1736830864888419689, 6527283474791389093, 6384762243253539014, 2821731454807287039, 5979682112198745494, 1918100215292224822, 1835645198031741635, 8997641803374437743, 3580116199846324783, 6492556664465137528, 5516591985097249889, 8787591111464386263, 7552220938949813566, 4338082736649823490, 6994976010843053637, 8853703607690376831, 9205033344599577766, 8764904730474825358, 6985061414210790941, 8605838691883809431, 3008410449435392766, 1423284941046612886, 7912007415600994801, 4109372616074578582, 1277222996461930937, 4260458800983946076, 5054377619196118287, 6455604000790871996, 4592775393240611589, 4138920388757980329, 2015917313546974612, 4281072654400486385, 5569723954609626012, 892518312419013555, 3866213736765787309, 4421623050596924895, 9083483859520588762, 5726167603500100258, 4803609534680869705, 186401887909657446, 4660047197741436150, 5820715501278594354, 7167306979143222105, 3938605778339812748, 6231424089947560870, 8211649659012609222, 2377056664510163324, 4086184391625428402, 697517385233176437, 8214562593974635142, 2449880038560811324, 5906768742891628402, 95265982614297522, 2381649565357438050, 4201006912807296552, 3568080414779880187, 6191662037804022628, 7217598355424153172, 5195890185363089423, 770046118110374613, 804408879049813759, 1663477902535792409, 4693459415975707093, 6656020957135367929, 379827264998234131, 272309588101077492, 6807739702526937300, 4172795899787468406, 2862805089284176537, 7006522974120982944, 9142377689638609506, 7198513356450618858, 4718765211024731573, 7288665833360979929, 6972577133783758348, 8293731681207994606, 4429107219394797924, 47216042612638704, 1180401065315967600, 1839910522334862651, 9104274910952463143, 6245943889296959783, 8574644642747582047, 2228559221029708166, 373748304614049452, 120335578496460517, 3008389462411512925, 1422760265449616861, 7898890525676094176, 3781450367952062957, 2302538830253816095, 2223238535216747677, 240731159290037227, 6018278982250930675, 2883021966596854347, 7511944906937928194, 3331181936352689190, 269200077124247703, 6730001928106192575, 2229351539268850281, 393556260592602327, 615534477960282392, 6164989912152284017, 6550795214130687897, 6972555726736009114, 8293196505014263756, 4415727814551526674, 8936102958385633237, 2041645075126212133, 4924266693881424410, 3202830867923525071, 6283795403249920511, 297560454716824464, 7439011367920611600, 1507843460919774340, 802598375575255368, 1618215315671832634, 3561894744376712718, 6037020277724835903, 3351554353444485047, 778510504419144128, 1016018536769051634, 6953719345516739284, 7822286974532518006, 1866361589362658707, 542179549792588760, 4331116707959943217, 6820825293596046812, 4499935676515206206, 1817927470622845754, 8554698618152040718, 1729908606141174941, 6354227006110270393, 2058350526225571514, 5341902971365408935, 4420365768168362413, 9052051798806526712, 4940366085648549008, 3605315662101640021, 7122543220848018478, 2819511820959722073, 5924191266009621344, 530829060564121072, 4047354477248251017, 8950141562658517595, 2392610181948321083, 4475022327579372377, 1195093747227000029, 2207227570110673376, 9063829068492955485, 5234797827809268333, 1742737179264847363, 6674941334202080943, 852836691666059481, 2874173217941935459, 7290726190564955994, 7024086063883159973, 358082896838259448, 8952072420956486200, 2440881639397536208, 5681808763809750502, 3694638542422125805, 132243192005387295, 3306079800134682375, 8865018708528853111, 264538828706708983, 6613470717667724575, 8539443315161926064, 1348526031388308591, 6043034674143387426, 3501914263908273122, 4537508266013846003, 2757242208088840679, 4367450944237586494, 7729181200537128737, 8762089276332702765, 6914675060657726116, 6846179853057188806, 5133799663043756056, 8441155096981816221, 8114692613740338299, 9176502569558166032, 8051635354439532008, 7600071087038008757, 5534336438854703265, 7830418545944880, 195760463648622000, 4894011591215550000, 2446453301276664821, 5821100310787965827, 7176927216877508930, 4179111721696983373, 3020700637022050712, 1730539630713061536, 6370002620407435268, 2452740883654693389, 5978289870238680027, 1883294166290588147, 965493972990824760, 5690605251061067434, 3914550723705049105, 5630047724078469795, 2400612549140108130, 4675081507374048552, 6196573242093904404, 7340378462671197572, 8265392866539199423, 3720636852674918349, 782200948325200895, 1108279634420470809, 36874749947442876, 921868748686071900, 4599974643442245934, 4318901643798838954, 6515448689568440237, 6088892612679817614, 4648362727319027822, 5528603740718386154, 9087885001992792888, 5836196165305203408, 7554323579808448455, 4390648758115695715, 8309126547489859262, 4813978876441414324, 445635431923272921, 1917513761227047242, 1820983846402302135, 8631108012638450243, 3640143468301413066, 7993238375842344603, 6140146622108323632, 5929712963031678272, 668871486115544272, 7498415116033831017, 2992937163750259765, 1036452798918287861, 7464575899247644959, 2146956744095608315, 7557058418116328960, 4459019715812708340, 795028453060399104, 1428967252800426034, 8054065209446323501, 7660817462207796082, 7052995818099386390, 1080826752243919873, 8573924732388445259, 2210561462051288466, 9147176367008332735, 7318480290693699583, 7717938567101749698, 8481023440448226790, 9111401200400602524, 6424101125500444308, 3805203510979919389, 2896367405950226895, 7845580890772241894, 2448709495355755907, 5877505162765242977, 8587048516309437680, 2538656060076098991, 8126169280773820077, 240047208540434699, 6001180213510867475, 2455552748095274347, 6048586481253203977, 3640709441653686897, 8007387709649190378, 6493879967279468007, 5549674555455511864, 391283333566159855, 558711302299220592, 4744410520625739017, 7929798573386166029, 4554151560703859282, 3173324575339172654, 5546138088641110086, 302871663206115405, 7571791580152885125, 4827348766726612465, 779882689053226446, 1050323152621109584, 7811334741818188034, 1592555771504409407, 2920406140191132043, 8446549246794870594, 8249546359066697624, 3324474165862373374, 101505814866352303, 2537645371658807575, 8100902070341534677, 8831738984588075482, 8655917767042044041, 4260387328391258016, 5052590804378916787, 6410933630360834496, 3476016132489674089, 3890054980548870178, 5017654145173996620, 5537517150237830321, 87348203124121280, 2183705078103032000, 8475766768301921085, 8979984396742959899, 3138681034059378683, 4680049556646260811, 6320774473899210879, 1222037220949083664, 2880814413162764251, 7456756071085675794, 1951461040046379190, 2669665816885600835, 2178041164156590394, 8334168919640880935, 5440038180216956149, 6873745989457042763, 5822953073040104981, 7223246273180987780, 5337088129283954623, 4299994716132004613, 6042775497897581712, 3495434857763130272, 4375523112385274753, 7930985404229335212, 4583822331783088857, 3915093852319912029, 5643625939450042895, 2740067933429435630, 3938094077752460269, 6218631575263748895, 7891836791917309847, 3605107023982454732, 7117327267868386253, 2689112996468916448, 2664220653739480719, 2041912085503587494, 4930941953315808435, 3369712353783125696, 1232460512885160353, 3141396711564681476, 4747941494278830636, 8018072914713456504, 6761010093886121157, 3004555683767064831, 1326915799338414511, 5502778872896035426, 8442263306434024688, 8142397850045549974, 645761440333682124, 6920663971487277317, 6995902623795968831, 8876868931513256681, 560794403316798233, 4796488046065180042, 8364672517415871, 209116812935396775, 5227920323384919375, 1570799568656123413, 2376501068983982193, 4072294503470900127, 350270181369969562, 8756754534249239050, 6781306508571133241, 3511966050892366931, 4788802940616191228, 9039609073147471304, 4629297944172163808, 5051984162046785804, 6395767572057559921, 3096864674907809714, 3634640577857036586, 7855666114732932603, 2700840094373023632, 2957398101342160319, 147976238715801711, 3699405967895042775, 251428828828311545, 6285720720707788625, 345693391163527314, 8642334779088182850, 3920812629544728241, 5786595370070448195, 6314303698939568130, 1060267846958014939, 8059952100240821909, 7807989732070256282, 1508930527806115607, 829775047733787043, 2297632119635124509, 2100570769749458027, 6397409059462571760, 3137901860033105689, 4660570205989435961, 5833790707478589629, 7494187134143103980, 2887237616482083840, 7617336154068665519, 5965963114621122315, 1575125275851645347, 2484643748872030543, 6775861500672108877, 3375840853416757831, 1385673003725963728};

/*
 * Define structs that used in the functions in "ExprFunctions.hpp"
 * below. For example,
 *
 *   struct Person {
 *     string name;
 *     int age;
 *     double height;
 *     double weight;
 *   }
 *
 */

#endif /* EXPRUTIL_HPP_ */
